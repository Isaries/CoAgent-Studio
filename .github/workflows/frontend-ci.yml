name: Frontend CI

on:
  push:
    branches: [ "main" ]
    paths:
      - 'frontend/**'
  pull_request:
    branches: [ "main" ]
    paths:
      - 'frontend/**'

jobs:
  build-and-lint:
    runs-on: ubuntu-latest
    
    defaults:
      run:
        working-directory: ./frontend

    steps:
    - uses: actions/checkout@v4

    - name: Set up Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '20'
        cache: 'npm'
        cache-dependency-path: frontend/package-lock.json

    - name: Install dependencies
      run: npm ci

    - name: Run ESLint
      run: npm run lint:check
      # Note: We use lint:check (without --fix) if available, or just verify 'npm run lint' returns 0 but doesn't modify files?
      # npm run lint often includes --fix. We should create a check-only script or pass flags.
      # frontend/package.json `lint` command is `eslint . ... --fix`.
      # We should override it or add a specific check command.
      # Let's verify package.json content first. If needed, we add a script.
      # For now, running `npm run lint` might exit 0 even if it fixed things, which hides errors?
      # Ideally CI should fail if formatting is needed.
      # We will check package.json first. 
    
    - name: Check Formatting (Prettier)
      run: npx prettier --check "src/**/*.{ts,tsx,vue,js,json,css,html}"
